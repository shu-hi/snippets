import numpy as np
import pandas as pd
from scipy import stats
import statsmodels.api as sm
import scipy
from statsmodels.stats.outliers_influence import variance_inflation_factor
import matplotlib.pyplot as plt
from scipy.stats import beta as s_s_beta
# ğŸ“Š ç¿’ç†Ÿåº¦ãƒã‚§ãƒƒã‚¯ï¼ˆå…¨10å•ï¼‰
# å‰æ

# Pythonã‚³ãƒ¼ãƒ‰ã¯ å®Ÿè¡Œä¸è¦ã€è€ƒãˆæ–¹ã‚„çµæœã‚’æ›¸ã„ã¦ãã ã•ã„

# æ•°å¼ã§ã‚‚ã‚³ãƒ¼ãƒ‰ã§ã‚‚æ—¥æœ¬èªèª¬æ˜ã§ã‚‚OK

# åˆ†ã‹ã‚‰ãªã„å•é¡Œã¯ã€Œåˆ†ã‹ã‚‰ãªã„ã€ã¨æ›¸ã„ã¦OKï¼ˆãã‚Œã‚‚é‡è¦ãªæƒ…å ±ã§ã™ï¼‰

# Q1ï¼ˆåŸºç¤ï¼šå¹³å‡ãƒ»åˆ†æ•£ï¼‰

# æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚

# x = [2, 4, 4, 4, 5, 5, 7, 9]


# å¹³å‡ã¯ã„ãã¤ã‹

# åˆ†æ•£ã¯ã„ãã¤ã‹

# ã€Œå¹³å‡ã¨ã®å·®ãŒå¤§ãã„ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„ã€ã¨ã¯ã€ã©ã®çµ±è¨ˆé‡ã‚’è¦‹ã‚Œã°ã‚ˆã„ã‹

# Q2ï¼ˆçµ±è¨ˆã¨Pythonï¼‰

# x ã® æ¨™æœ¬åˆ†æ•£ã‚’ NumPy ã§è¨ˆç®—ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚

# â€»æ¯åˆ†æ•£ã¨ã®é•ã„ãŒåˆ†ã‹ã‚Œã°è¨€è‘‰ã§è£œè¶³ã—ã¦ãã ã•ã„ã€‚

# Q3ï¼ˆç¢ºç‡ã®ç†è§£ï¼‰

# ã‚³ã‚¤ãƒ³ã‚’10å›æŠ•ã’ãŸã¨ãã€è¡¨ãŒ7å›å‡ºã‚‹ç¢ºç‡ã¯ä½•åˆ†å¸ƒã«å¾“ã„ã¾ã™ã‹ï¼Ÿ
# ã¾ãŸã€ãã®ç¢ºç‡ã‚’è¡¨ã™å¼ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚

# Q4ï¼ˆåˆ†å¸ƒã®ç›´æ„Ÿï¼‰

# æ¬¡ã®ã†ã¡ã€æ­£è¦åˆ†å¸ƒã§ã‚ã‚‹å¯èƒ½æ€§ãŒæœ€ã‚‚ä½ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿç†ç”±ã‚‚ã€‚

# æˆäººç”·æ€§ã®èº«é•·

# ãƒ†ã‚¹ãƒˆã®ç‚¹æ•°ï¼ˆ0ã€œ100ç‚¹ï¼‰

# æ¸¬å®šèª¤å·®

# ã‚µã‚¤ã‚³ãƒ­ã®å‡ºç›®

# Q5ï¼ˆpandasã®åŸºç¤ï¼‰

# æ¬¡ã® DataFrame df ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚

# score
# 52
# 68
# 90
# 71
# 84

# å¹³å‡ãƒ»ä¸­å¤®å€¤ãƒ»å››åˆ†ä½ç¯„å›²ï¼ˆIQRï¼‰ã‚’ pandas ã§æ±‚ã‚ã‚‹ã«ã¯ã©ã†ã—ã¾ã™ã‹ï¼Ÿ

# Q6ï¼ˆå¯è¦–åŒ–ï¼‰

# æ¬¡ã®ç›®çš„ã«æœ€ã‚‚é©ã—ãŸã‚°ãƒ©ãƒ•ã‚’ç­”ãˆã¦ãã ã•ã„ã€‚

# åˆ†å¸ƒã®å½¢ã‚’è¦‹ãŸã„

# å¤–ã‚Œå€¤ã‚’ç¢ºèªã—ãŸã„

# 2å¤‰æ•°ã®é–¢ä¿‚ã‚’è¦‹ãŸã„

# ï¼ˆã‚°ãƒ©ãƒ•åã§OKï¼‰

# Q7ï¼ˆçµ±è¨ˆçš„æ¨æ¸¬ï¼‰

# ã€Œå¹³å‡50ç‚¹ã®ãƒ†ã‚¹ãƒˆã§ã€ã‚ã‚‹ã‚¯ãƒ©ã‚¹ã®å¹³å‡ãŒ62ç‚¹ã ã£ãŸã€

# ã“ã®ã¨ã

# ã€Œã“ã®ã‚¯ãƒ©ã‚¹ã¯æœ¬å½“ã«å„ªç§€ã ã¨è¨€ãˆã‚‹ã‹ï¼Ÿã€

# ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’3ã¤ä»¥ä¸ŠæŒ™ã’ã¦ãã ã•ã„ã€‚

# Q8ï¼ˆä»®èª¬æ¤œå®šï¼‰

# æ¬¡ã®ã†ã¡ å¸°ç„¡ä»®èª¬ã¨ã—ã¦é©åˆ‡ãªã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ

# ã€Œæ–°ã—ã„å­¦ç¿’æ³•ã¯ã€å¾“æ¥æ³•ã‚ˆã‚Šç‚¹æ•°ã‚’ä¸Šã’ã‚‹ã€

# æ–°ã—ã„å­¦ç¿’æ³•ã®å¹³å‡ç‚¹ã¯å¾“æ¥æ³•ã¨ç­‰ã—ã„

# æ–°ã—ã„å­¦ç¿’æ³•ã®å¹³å‡ç‚¹ã¯å¾“æ¥æ³•ã‚ˆã‚Šé«˜ã„

# æ–°ã—ã„å­¦ç¿’æ³•ã¯åŠ¹æœãŒã‚ã‚‹

# ç†ç”±ã‚‚æ›¸ã„ã¦ãã ã•ã„ã€‚

# Q9ï¼ˆç›¸é–¢ã¨å› æœï¼‰

# ã€Œã‚¢ã‚¤ã‚¹ã®å£²ä¸Šã¨æ°´é›£äº‹æ•…æ•°ã«ã¯å¼·ã„ç›¸é–¢ãŒã‚ã‚‹ã€

# ã“ã‚Œã¯å› æœé–¢ä¿‚ã‹ï¼Ÿ

# çµ±è¨ˆçš„ã«ã©ã†è€ƒãˆã‚‹ã¹ãã‹ï¼Ÿ

# Q10ï¼ˆå®Ÿå‹™å¯„ã‚Šï¼‰

# æ¬¡ã®ã†ã¡ã€çµ±è¨ˆçš„ã«ä¸€ç•ªå±é™ºãªåˆ¤æ–­ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ

# ã‚µãƒ³ãƒ—ãƒ«æ•°ãŒå¤šã„ã®ã§på€¤ã ã‘è¦‹ã¦åˆ¤æ–­ã™ã‚‹

# å¹³å‡ã ã‘ã§åˆ†å¸ƒã‚’è¦‹ãªã„

# å¤–ã‚Œå€¤ã‚’ç†ç”±ãªãå‰Šé™¤ã™ã‚‹

# ä¸Šè¨˜ã™ã¹ã¦

# âœï¸ å›ç­”æ–¹æ³•

# Q1ã€œQ10ã‚’ç•ªå·ä»˜ãã§ã¾ã¨ã‚ã¦å›ç­”ã—ã¦ãã ã•ã„

# ã‚³ãƒ¼ãƒ‰ï¼æ—¥æœ¬èªèª¬æ˜ã¯æ··åœ¨OK

# ä¸æ˜ãªå•é¡Œã¯ç©ºæ¬„ orã€Œåˆ†ã‹ã‚‰ãªã„ã€ã§OK
# Q1
x = [2, 4, 4, 4, 5, 5, 5, 7, 9]
mean = np.mean(x)
print(mean)  # 5.0
sum = 0
for i in x:
    sum += i
print(sum / len(x))  # åˆ¥è§£ã€€5.0

s2 = np.var(x)
print(s2)  # 3.5555555555555554

s2_manual = 0
for i in x:
    s2_manual += np.power((sum / len(x) - i), 2)
print(s2_manual / len(x))  # åˆ¥è§£ã€€3.5555555555555554

# åˆ†æ•£

# Q2ã€€æ„å›³ä¸æ˜ã€€æ™®éåˆ†æ•£ã§ã‚ã‚Œã°
print(s2_manual / (len(x) - 1))
# æ¨™æœ¬åˆ†æ•£ã¯æ¯é›†å›£ã‹ã‚‰ã¨ã£ãŸæ¨™æœ¬ã®åˆ†æ•£ã€€æ¯åˆ†æ•£ã¯æ¯é›†å›£ã®åˆ†æ•£

# Q3 ã¡ã‚‡ã†ã©7å›å‡ºã‚‹ã¨ã„ã†ç†è§£ã§é€²ã‚ã‚‹ã€€10C7*0.5^7*(1-0.5)^3
print(
    (10 * 9 * 8 * 7 * 6 * 5 * 4 * 3)
    / (7 * 6 * 5 * 4 * 3 * 2)
    * np.power(0.5, 7)
    * np.power(0.5, 3)
)  # 0.3515625
# Q4ã€€4ãŒä¸€ã¤ã®ã‚µã‚¤ã‚³ãƒ­ã®å‡ºç›®ã¨ã„ã†ç†è§£ã§é€²ã‚ã‚‹ã€€4ã¯ä¸€æ§˜åˆ†å¸ƒ

# Q5
df = pd.DataFrame([52, 68, 90, 71, 84])
print(df.mean())
print(df.median())
print(df.quantile(q=0.75) - df.quantile(q=0.25))

# Q6 ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‹ç®±ã²ã’å›³ã€æ•£å¸ƒå›³
# Q7ã€€ã‚¯ãƒ©ã‚¹ã‚’å«ã‚€é›†å›£ã¨ãã®ã‚¯ãƒ©ã‚¹ã®å¹³å‡ã€åˆ†æ•£
# Q8ã€€1ã€€ä»®èª¬æ¤œå®šã§ã¯åŠ¹æœãŒãªã„å¸°ç„¡ä»®èª¬ã‚’ä»®å®šã—ã¦æ¤œå®šã—ã€æ£„å´ã•ã‚Œã‚Œã°åŠ¹æœãŒã‚ã‚‹ã¨çµè«–ã¥ã‘ã‚‹
# Q9  ç›¸é–¢ã€€æ°—æ¸©ã‚„æµ·ã«éŠã³ã«è¡Œãäººæ•°ã®äº¤çµ¡
# 10 4

# æ¬¡ã®èª²é¡Œï¼ˆãƒ¬ãƒ™ãƒ«1ï¼‰
# å•é¡ŒA
# ã‚ã‚‹ã‚¯ãƒ©ã‚¹30äººã®ãƒ†ã‚¹ãƒˆçµæœï¼š
# å¹³å‡ï¼š62
# æ¨™æº–åå·®ï¼š10
# æ¯å¹³å‡50ã€æ¯æ¨™æº–åå·®10ã¨ä»®å®šã™ã‚‹ã€‚
# ã“ã®å•é¡Œã§ä½¿ã†ã¹ãæ¤œå®šã¯ï¼Ÿ
# å¸°ç„¡ä»®èª¬ãƒ»å¯¾ç«‹ä»®èª¬ã‚’æ›¸ã‘
# æ¤œå®šçµ±è¨ˆé‡ã‚’æ›¸ã‘ï¼ˆæ•°å¼ or Pythonï¼‰
# ä½•ãŒåˆ†ã‹ã‚Œã°ã€Œå„ªç§€ã€ã¨è¨€ãˆã‚‹ã‹ï¼Ÿ
# å•é¡ŒBï¼ˆPythonå¯„ã‚Šï¼‰
# æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã®çµ±è¨ˆçš„ã«å±é™ºãªç‚¹ã‚’æŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚
# import numpy as np
# data = np.random.normal(50, 10, 5)
# if np.mean(data) > 55:
#     print("æœ‰æ„ã«é«˜ã„")

# A å¸°ç„¡ä»®èª¬:æ¨™æœ¬å¹³å‡=æ¯å¹³å‡ã€€å¯¾ç«‹ä»®èª¬:æ¨™æœ¬å¹³å‡>æ¯å¹³å‡
t = (62 - 50) / (10 / np.sqrt(30))
print(t)  # 6.572670690061993
print(stats.t.sf(t, 30 - 1))  # 1.6768901834771843e-07ã€€æœ‰æ„

# Bã€€æ­£è¦åˆ†å¸ƒã«å¾“ã£ãŸä¹±æ•°ã®å¹³å‡ãŒ55ä»¥ä¸Šãªã‚‰æœ‰æ„ã¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã€€np.random.normalãŒæ­£ã—ãå‹•ã„ã¦ã„ã‚‹ã‹ã®ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ï¼Ÿ

# Cã€€æ¨™æœ¬é›†å›£ã®å¹³å‡å€¤ã«ã¤ã„ã¦ç‰‡å´æ¤œå®šã‚’è¡Œã£ãŸã¨ã“ã‚ã€ä¿¡é ¼åŒºé–“95%ã§æœ‰æ„å·®ãŒã‚ã£ãŸã®ã§é«˜ã„å‚¾å‘ã«ã‚ã‚‹ã¨ã„ãˆã‚‹

# Dã€€å¯¾å¿œã®æœ‰ç„¡ã€æ¯åˆ†æ•£ãŒç­‰ã—ã„ã‹ã©ã†ã‹ã€æ­£è¦åˆ†å¸ƒã«å¾“ã£ã¦ã„ã‚‹ã‹

# x1, x2, ..., xn ~ N(Î¼, ÏƒÂ²)
# ã“ã‚Œã¯
# ã€Œå¹³å‡Î¼ã€åˆ†æ•£ÏƒÂ²ã®æ­£è¦åˆ†å¸ƒã‹ã‚‰ç‹¬ç«‹ã«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã•ã‚ŒãŸã€
# ã¨ã„ã†ãƒ¢ãƒ‡ãƒ«å®£è¨€ã§ã™ã€‚

# l(Î¼,Ï^2)'=-(2nÏ+n(n+1))/2Ï^2

# Q1ï¼ˆæ¤œå®šã®é¸æŠï¼‰
# æ¬¡ã®çŠ¶æ³ã§ æœ€ã‚‚é©åˆ‡ãªæ¤œå®š ã‚’ç­”ãˆãªã•ã„ã€‚
# æ¯åˆ†æ•£æ—¢çŸ¥ã€æ¨™æœ¬æ•°30ã€å¹³å‡ã®å·®ã‚’è¦‹ãŸã„
# æ¯åˆ†æ•£æœªçŸ¥ã€æ¨™æœ¬æ•°8ã€æ­£è¦æ€§ã¯æ€ªã—ã„
# 2ç¾¤ã®å¹³å‡ã‚’æ¯”è¼ƒã€åˆ†æ•£ãŒæ˜ã‚‰ã‹ã«ç•°ãªã‚‹
# å‰å¾Œæ¯”è¼ƒï¼ˆåŒã˜äººã®ãƒ†ã‚¹ãƒˆå‰å¾Œï¼‰
# Q2ï¼ˆå‰ææ¡ä»¶ï¼‰
# tæ¤œå®šã‚’ä½¿ã†ãŸã‚ã«å¿…è¦ãªå‰ææ¡ä»¶ã‚’ 3ã¤ä»¥ä¸Š æ›¸ããªã•ã„ã€‚
# Q3ï¼ˆpå€¤ã®è§£é‡ˆï¼‰
# på€¤ = 0.03 ã ã£ãŸã€‚
# æ¬¡ã®ã†ã¡ æ­£ã—ã„èª¬æ˜ ã‚’é¸ã³ã€ç†ç”±ã‚’æ›¸ããªã•ã„ã€‚
# A. å¸°ç„¡ä»®èª¬ãŒæ­£ã—ã„ç¢ºç‡ã¯3%
# B. å¶ç„¶ã§ã“ã®çµæœãŒå‡ºã‚‹ç¢ºç‡ã¯3%
# C. å¸°ç„¡ä»®èª¬ã®ã‚‚ã¨ã§ã€ã“ã‚Œä»¥ä¸Šæ¥µç«¯ãªçµæœãŒå‡ºã‚‹ç¢ºç‡ã¯3%
# D. åŠ¹æœãŒ97%ã®ç¢ºç‡ã§å­˜åœ¨ã™ã‚‹
# Q4ï¼ˆä¿¡é ¼åŒºé–“ï¼‰
# 95%ä¿¡é ¼åŒºé–“ãŒ [58, 66] ã®ã¨ãã€æ¬¡ã¯æ­£ã—ã„ã‹ï¼Ÿ
# çœŸã®å¹³å‡ã¯58ã€œ66ã«ã‚ã‚‹ç¢ºç‡ãŒ95%
# ã“ã®åŒºé–“ã«æ¯å¹³å‡50ã¯å«ã¾ã‚Œã‚‹ã‹
# ä»®èª¬æ¤œå®šã¨ã®é–¢ä¿‚ã¯ï¼Ÿ
# Q5ï¼ˆåŠ¹æœé‡ï¼‰
# å¹³å‡å·®ãŒ æœ‰æ„ ã ã£ãŸã€‚
# ãã‚Œã§ã‚‚ å®Ÿå‹™çš„ã«æ„å‘³ãŒãªã„ å¯èƒ½æ€§ãŒã‚ã‚‹ç†ç”±ã‚’ç­”ãˆãªã•ã„ã€‚
# Q6ï¼ˆå¤šé‡æ¤œå®šï¼‰
# 20å€‹ã®ä»®èª¬ã‚’ã™ã¹ã¦ Î±=0.05 ã§æ¤œå®šã—ãŸã€‚
# ä½•ãŒå•é¡Œã‹ï¼Ÿ
# ã©ã†å¯¾å‡¦ã™ã‚‹ï¼Ÿ
# Q7ï¼ˆå¤–ã‚Œå€¤ï¼‰
# å¤–ã‚Œå€¤ã‚’å‰Šé™¤ã—ã¦ã‚ˆã„ã‚±ãƒ¼ã‚¹ãƒ»ãƒ€ãƒ¡ãªã‚±ãƒ¼ã‚¹ã‚’
# ãã‚Œãã‚Œ1ã¤ãšã¤æŒ™ã’ãªã•ã„ã€‚
# Q8ï¼ˆæ­£è¦æ€§ï¼‰
# ãƒ‡ãƒ¼ã‚¿ãŒæ­£è¦åˆ†å¸ƒã«å¾“ã£ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’
# 2ã¤ä»¥ä¸Š æŒ™ã’ãªã•ã„ã€‚
# Q9ï¼ˆãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ï¼‰
# æ¬¡ã®æ¤œå®šã® ç”¨é€”ã®é•ã„ ã‚’èª¬æ˜ã—ãªã•ã„ã€‚
# tæ¤œå®š
# Mannâ€“Whitney Uæ¤œå®š
# Q10ï¼ˆå®Ÿå‹™åˆ¤æ–­ï¼‰
# æ¬¡ã®çµè«–ã®ã†ã¡ã€ä¸€ç•ªå±é™º ãªã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ
# på€¤ãŒå°ã•ã„ã®ã§æ–½ç­–ã‚’å…¨ç¤¾å±•é–‹ã™ã‚‹
# åŠ¹æœé‡ãŒå°ã•ã„ãŒæœ‰æ„ãªã®ã§æˆåŠŸ
# åˆ†å¸ƒã‚’è¦‹ãšã«å¹³å‡ã ã‘ã§åˆ¤æ–­
# ä¸Šè¨˜ã™ã¹ã¦
#
# Q1 1 tæ¤œå®š 2 Zæ¤œå®š 3 welchã®tæ¤œå®š 4å¯¾å¿œã®ã‚ã‚‹tæ¤œå®š
# Q2 ãƒ©ãƒ³ãƒ€ãƒ æŠ½å‡ºã€æ­£è¦åˆ†å¸ƒã«å¾“ã†ã€ååˆ†ãªã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º
# Q3ã€€C
# Q4 çœŸã®å¹³å‡ã¯58ã€œ66ã«ã‚ã‚‹ç¢ºç‡ãŒ95%:å½(æŠ½å‡ºã‚’ç¹°ã‚Šè¿”ã—ãŸæ™‚95%ãŒçœŸã®å¹³å‡ã‚’å«ã‚€)ã€€ã“ã®åŒºé–“ã«æ¯å¹³å‡50ã¯å«ã¾ã‚Œã‚‹ã‹:å«ã¾ã‚Œãªã„ã€€ä»®èª¬æ¤œå®šã¨ã®é–¢ä¿‚ã¯ï¼Ÿã‚‚ã—æ¯å¹³å‡50ãªã‚‰ã§æ¨™æœ¬ã®95%ä¿¡é ¼åŒºé–“ãŒ [58, 66] ã®ã¨ãæ¨™æœ¬é›†å›£ã®å¹³å‡ã¯æ¯å¹³å‡ã®ãã‚Œã‚ˆã‚Šæœ‰æ„ã«é«˜ã„
# Q5ã€€å·®ãŒç„¡è¦–ã§ãã‚‹å°ã•ã•ã€€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒå°ã•ã„ã€€ã‚µãƒ³ãƒ—ãƒ«ãŒåã£ã¦ã„ã‚‹
# Q6ã€€è¤‡æ•°æ¤œå®šã‚’ç¹°ã‚Šè¿”ã™ã¨å¶ç„¶æœ‰æ„å·®ãŒæ¤œå‡ºã•ã‚Œã‚‹å¯èƒ½æ€§ã‚‚é«˜ã¾ã‚‹ã®ã§ã‚ˆã‚Šæœ‰æ„æ°´æº–ã‚’å³ã—ãã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
# Q7ã€€ã‚ˆã„:åŸå› ãŒã‚ã‹ã£ã¦ã„ã‚‹æ˜ã‚‰ã‹ãªæŠ½å‡ºãƒŸã‚¹(äººæ•°èª¿æŸ»ã§å€¤ãŒãƒã‚¤ãƒŠã‚¹ã®å ´åˆãªã©)ã€€ãƒ€ãƒ¡:å¤–ã‚Œå€¤ãŒé‡è¦ãªã‚±ãƒ¼ã‚¹(ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ†æã§è³¼å…¥é¡ãŒé«˜ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã©)
# Q8ã€€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’è¦‹ã‚‹
# Q9ã€€æ­£è¦æ€§ã‚’ä»®å®šã™ã‚‹ã‹ã©ã†ã‹
# Q10ã€€4
# Q1ï¼ˆå˜å›å¸°åˆ†æï¼‰
# æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦å˜å›å¸°åˆ†æã‚’è¡Œã„ãªã•ã„ã€‚
# X (åºƒå‘Šè²»)	Y (å£²ä¸Š)
# 1	10
# 2	12
# 3	14
# 4	16
# 5	18
# å˜å›å¸°ãƒ¢ãƒ‡ãƒ«ã®å¼ã‚’æ±‚ã‚ãªã•ã„ï¼ˆç›´ç·šã®å‚¾ãã¨åˆ‡ç‰‡ï¼‰ã€‚
# å›å¸°ç›´ç·šã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã€ãƒ‡ãƒ¼ã‚¿ç‚¹ã¨ç›´ç·šã‚’æ¯”è¼ƒã—ãªã•ã„ã€‚
# Q2ï¼ˆé‡å›å¸°åˆ†æï¼‰
# æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦é‡å›å¸°åˆ†æã‚’è¡Œã„ãªã•ã„ã€‚
# X1 (åºƒå‘Šè²»)	X2 (è²©å£²å“¡æ•°)	Y (å£²ä¸Š)
# 1	2	10
# 2	3	12
# 3	4	14
# 4	5	16
# 5	6	18
# é‡å›å¸°ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã€å¼ã‚’æ±‚ã‚ãªã•ã„ã€‚
# ãã‚Œãã‚Œã®èª¬æ˜å¤‰æ•°ãŒå£²ä¸Šã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è§£é‡ˆã—ãªã•ã„ã€‚
# Q3ï¼ˆãƒ€ãƒŸãƒ¼å¤‰æ•°ï¼‰
# ã‚ã‚‹ä¼æ¥­ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã€ç‰¹å®šã®å­£ç¯€ï¼ˆå†¬ã€å¤ï¼‰ãŒå£²ä¸Šã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã¨ä»®å®šã—ã¦ã„ã¾ã™ã€‚å†¬ã‚’0ã€å¤ã‚’1ã¨ã™ã‚‹ãƒ€ãƒŸãƒ¼å¤‰æ•°ã‚’ä½¿ã£ã¦å›å¸°åˆ†æã‚’è¡Œã„ãªã•ã„ã€‚
# ãƒ€ãƒŸãƒ¼å¤‰æ•°ã‚’ä½¿ã£ã¦å›å¸°å¼ã‚’æ§‹ç¯‰ã—ãªã•ã„ã€‚
# ãã®çµæœã‚’è§£é‡ˆã—ã€å­£ç¯€åŠ¹æœãŒå£²ä¸Šã«ã©ã†å½±éŸ¿ã—ã¦ã„ã‚‹ã‹ã‚’è¿°ã¹ãªã•ã„ã€‚
# Q4ï¼ˆäº¤çµ¡ã¨å› æœæ¨è«–ï¼‰
# ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€äº¤çµ¡ã®å¯èƒ½æ€§ã‚’è©•ä¾¡ã—ã€å› æœæ¨è«–ã«ã¤ã„ã¦è€ƒå¯Ÿã—ãªã•ã„ã€‚
# X (é‹å‹•æ™‚é–“)	Y (ä½“é‡æ¸›å°‘)	Z (é£Ÿäº‹åˆ¶é™)
# 1	2	3
# 2	4	4
# 3	6	5
# 4	7	6
# 5	8	7
# X (é‹å‹•æ™‚é–“)ã¨Y (ä½“é‡æ¸›å°‘)ã®é–¢ä¿‚ã‚’èª¿ã¹ã‚‹éš›ã€**Z (é£Ÿäº‹åˆ¶é™)**ã®å½±éŸ¿ã‚’ã©ã†æ‰±ã†ã¹ãã‹ã€‚
# äº¤çµ¡å¤‰æ•°ãŒã‚ã‚‹å ´åˆã€å› æœæ¨è«–ã®ç²¾åº¦ãŒã©ã†å¤‰ã‚ã‚‹ã‹ã‚’èª¬æ˜ã—ãªã•ã„ã€‚
# Q5ï¼ˆA/Bãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼‰
# A/Bãƒ†ã‚¹ãƒˆã‚’è¨­è¨ˆã™ã‚‹éš›ã® é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ ã‚’5ã¤æŒ™ã’ãªã•ã„ã€‚
# ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®æ±ºå®šæ–¹æ³•
# å®Ÿæ–½å‰ã«ç¢ºèªã™ã‚‹ã¹ãã“ã¨
# çµæœã®è§£é‡ˆæ–¹æ³•
# æœ‰æ„æ°´æº–ï¼ˆÎ±ï¼‰ã®è¨­å®š
# çµæœã‚’ã©ã†å ±å‘Šã™ã‚‹ã‹
# Q6ï¼ˆA/Bãƒ†ã‚¹ãƒˆè§£æï¼‰
# ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã€Aï¼ˆå¤‰æ›´å‰ï¼‰ã¨Bï¼ˆå¤‰æ›´å¾Œï¼‰ã®ãƒšãƒ¼ã‚¸ã«å¯¾ã—ã¦ã€ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ã‚’æ¯”è¼ƒã™ã‚‹A/Bãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ã¾ã—ãŸã€‚
# Aã®ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ã¯0.10ã€Bã®ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ã¯0.12ã€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯å„ã‚°ãƒ«ãƒ¼ãƒ—1000äººã§ã™ã€‚
# ã“ã®ãƒ†ã‚¹ãƒˆçµæœãŒæœ‰æ„ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ãªã•ã„ã€‚
# Q7ï¼ˆå›å¸°åˆ†æã¨å¤–ã‚Œå€¤ï¼‰
# æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦å˜å›å¸°åˆ†æã‚’è¡Œã£ãŸã¨ãã«ã€å¤–ã‚Œå€¤ãŒçµæœã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è€ƒå¯Ÿã—ãªã•ã„ã€‚
# X (åºƒå‘Šè²»)	Y (å£²ä¸Š)
# 1	10
# 2	12
# 3	14
# 4	16
# 100	80
# å¤–ã‚Œå€¤ãŒå›å¸°ç›´ç·šã«ä¸ãˆã‚‹å½±éŸ¿ã¯ã©ã†ã‹ï¼Ÿ
# ãã®å¤–ã‚Œå€¤ã‚’å‰Šé™¤ã—ãŸå ´åˆã®å½±éŸ¿ã‚’èª¬æ˜ã—ãªã•ã„ã€‚
# Q8ï¼ˆé‡å›å¸°åˆ†æã¨å…±ç·šæ€§ï¼‰
# æ¬¡ã®é‡å›å¸°ãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã€èª¬æ˜å¤‰æ•°é–“ã« å…±ç·šæ€§ ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’ç¢ºèªã—ã€å¯¾ç­–ã‚’è¿°ã¹ãªã•ã„ã€‚
# X1 (åºƒå‘Šè²»)	X2 (è²©å£²å“¡æ•°)	Y (å£²ä¸Š)
# 1	2	10
# 2	3	12
# 3	4	14
# 4	5	16
# 5	6	18
# X1 ã¨ X2 ã®ç›¸é–¢ã‚’èª¿ã¹ã€å…±ç·šæ€§ãŒã‚ã‚‹ã‹ç¢ºèªã—ãªã•ã„ã€‚
# å…±ç·šæ€§ã‚’è§£æ±ºã™ã‚‹æ–¹æ³•ã‚’ææ¡ˆã—ãªã•ã„ã€‚
# Q9ï¼ˆå› æœæ¨è«–ã®ãƒ¢ãƒ‡ãƒ«ï¼‰
# è¦³å¯Ÿãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å› æœæ¨è«–ã‚’è¡Œã†ãŸã‚ã®æ‰‹æ³•ï¼ˆä¾‹ãˆã°ã€å‚¾å‘ã‚¹ã‚³ã‚¢ãƒãƒƒãƒãƒ³ã‚°ã‚„å›å¸°ä¸é€£ç¶šè¨­è¨ˆãªã©ï¼‰ã«ã¤ã„ã¦èª¬æ˜ã—ã€å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ã«ã©ã†æ´»ç”¨ã™ã‚‹ã‹ã‚’è€ƒãˆãªã•ã„ã€‚
# Q10ï¼ˆçµ±è¨ˆçš„ã«æ­£ã—ã„ Ã— ãƒ“ã‚¸ãƒã‚¹çš„ã«æ­£ã—ã„ï¼‰
# æ¬¡ã®ã‚·ãƒŠãƒªã‚ªã«ã¤ã„ã¦ã€çµ±è¨ˆçš„ã«æ­£ã—ã„ã¨ãƒ“ã‚¸ãƒã‚¹çš„ã«æ­£ã—ã„ã®é•ã„ã‚’è§£èª¬ã—ã€ã©ã®ã‚ˆã†ã«èª¿æ•´ã™ã¹ãã‹ã‚’è€ƒå¯Ÿã—ãªã•ã„ã€‚
# A/Bãƒ†ã‚¹ãƒˆã§æœ‰æ„å·®ãŒå‡ºãŸãŒã€åŠ¹æœé‡ãŒå°ã•ãã€å®Ÿéš›ã®åç›Šå¢—åŠ ã«ã¯ã¤ãªãŒã‚‰ãªã„ã€‚
# å›å¸°åˆ†æã§æœ‰æ„ãªçµæœãŒå‡ºãŸãŒã€ãƒ“ã‚¸ãƒã‚¹ã®ç›®æ¨™ã¨ä¸€è‡´ã—ã¦ã„ãªã„ã€‚
# Q1 y=2x+8
# Q2 y=x1+x2+7 åºƒå‘Šè²»ã€è²©å£²å“¡æ•°ä¸€å˜ä½ã”ã¨ã«å£²ã‚Šä¸Šã’ãŒä¸€å˜ä½å¢—ãˆã‚‹
# Q3
nsample = 100
x = np.linspace(0, 1, nsample)
beta = np.array([1, 0.1])
e = np.random.normal(size=nsample)
X = sm.add_constant(x)
y_true = np.dot(X, beta)
y = y_true + e
model = sm.OLS(y, X)
res = model.fit()
print(res.summary())
# Q4 X,Zã®è£ã«ãƒ€ã‚¤ã‚¨ãƒƒãƒˆä¸­ã§ã‚ã‚‹ã‹ã©ã†ã‹ã¨ã„ã†äº¤çµ¡ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€€ãã®å ´åˆç²¾åº¦ã¯ä¸‹ãŒã‚‹
# Q5ã€€ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯å¤§ããã€ãƒ©ãƒ³ãƒ€ãƒ ã«è¿‘ã¥ãã‚ˆã†ã«(ã‚‚ã—è¦‹ãŸã„ç¾¤ãŒå¸Œå°‘ãªå ´åˆå±¤åˆ¥ã«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚‚å¯)ã€€ãƒã‚¤ã‚¢ã‚¹ãŒãªã„ã‹ç¢ºèªã€€çµæœã¯çµ±è¨ˆçš„æ¨è«–ã«å¾“ã†ã€€æœ‰æ„æ°´æº–ã¯å®Ÿé¨“å‰ã«æ±ºã‚ã¦å¤‰ãˆãªã„
# Q6
pooled = (100 + 120) / (1000 + 1000)
z = (0.12 - 0.10) / (pooled * (1 - pooled) * (1 / 1000 + 1 / 1000)) ** 0.5
print(scipy.stats.norm.sf(abs(z)))  # 0.0764588909319731 æœ‰æ„
# Q7 æœ¬æ¥ã®åˆ†å¸ƒã‹ã‚‰ãšã‚Œã‚‹
X = sm.add_constant([1, 2, 3, 4, 100])
y = [10, 12, 14, 16, 80]
model = sm.OLS(y, X)
res = model.fit()
print(res.summary())  # coef:0.6880
X = sm.add_constant([1, 2, 3, 4])
y = [10, 12, 14, 16]
model = sm.OLS(y, X)
res = model.fit()
print(res.summary())  # coef: 2.0000
# Q8
df = pd.DataFrame(
    {"X1": [1, 2, 3, 4, 5], "X2": [2, 3, 4, 5, 6], "y": [10, 12, 14, 16, 18]}
)
X = sm.add_constant(df[["X1", "X2"]])
y = df["y"]
model = sm.OLS(y, X)
res = model.fit()
print(res.summary())
vif = pd.DataFrame()
vif["VIF Factor"] = [
    variance_inflation_factor(df.values, i) for i in range(df.shape[1])
]
vif["features"] = df.columns
print(vif)
# /home/ubuntu/pandas/myenv/lib/python3.12/site-packages/statsmodels/stats/outliers_influence.py:197: RuntimeWarning: divide by zero encountered in scalar divide
#   vif = 1. / (1. - r_squared_i)
#    VIF Factor features
# 0         inf       X1
# 1         inf       X2
# 2         inf        y
# Q9 å‚¾å‘ã‚¹ã‚³ã‚¢ãƒãƒƒãƒãƒ³ã‚°ã¯åŒ»ç™‚ãªã©è¤‡é›‘ã«å½±éŸ¿ã•ã‚Œã‚‹åˆ†é‡ã€å›å¸°ä¸é€£ç¶šè¨­è¨ˆã¯å®Ÿé¨“ãã®ã‚‚ã®ãŒå½±éŸ¿ã‚’ä¸ãˆã¦ã—ã¾ã†åˆ†é‡
# Q10 A/Bãƒ†ã‚¹ãƒˆã§æœ‰æ„å·®ãŒå‡ºãŸãŒã€åŠ¹æœé‡ãŒå°ã•ãã€å®Ÿéš›ã®åç›Šå¢—åŠ ã«ã¯ã¤ãªãŒã‚‰ãªã„ã€‚->ãã‚‚ãã‚‚å½±éŸ¿åº¦ãŒé«˜ã„èª²é¡Œã‹ã‚‰åˆ†æã™ã¹ãã€€å›å¸°åˆ†æã§æœ‰æ„ãªçµæœãŒå‡ºãŸãŒã€ãƒ“ã‚¸ãƒã‚¹ã®ç›®æ¨™ã¨ä¸€è‡´ã—ã¦ã„ãªã„ã€‚->ç¾çŠ¶ã®èªè­˜ã®é•ã„ãŒåˆ†ã‹ã£ãŸæœ‰æ„ç¾©ãªçµæœ
# Q1ï¼ˆç›´æ„Ÿï¼‰
# äº‹å‰åˆ†å¸ƒãŒ å¼·ã™ãã‚‹ ã¨ä½•ãŒèµ·ã“ã‚‹ï¼Ÿ
# Q2ï¼ˆæ›´æ–°ï¼‰
# äº‹å‰åˆ†å¸ƒï¼šBeta(1,1)
# 10å›ä¸­7å›æˆåŠŸã—ãŸã€‚
# äº‹å¾Œåˆ†å¸ƒã¯ï¼Ÿ
# å¹³å‡ã¯ã„ãã¤ï¼Ÿ
# Q3ï¼ˆA/Bãƒ†ã‚¹ãƒˆï¼‰
# Aï¼š
# äº‹å‰ Beta(1,1)
# 100äººä¸­ 10CV
# Bï¼š
# äº‹å‰ Beta(1,1)
# 100äººä¸­ 14CV
# ã©ã¡ã‚‰ãŒè‰¯ã•ãã†ã‹ï¼Ÿ
# på€¤ã¯ç¦æ­¢ã€‚ç†ç”±ã‚‚ã€‚
# Q4ï¼ˆæ„æ€æ±ºå®šï¼‰
# ã€ŒBãŒAã‚ˆã‚Šè‰¯ã„ç¢ºç‡ãŒ90%ä»¥ä¸Šãªã‚‰ãƒªãƒªãƒ¼ã‚¹ã€
# ã“ã®åˆ¤æ–­ã®è‰¯ã„ç‚¹ãƒ»å±é™ºãªç‚¹ã€‚
# Q5ï¼ˆä¿¡é ¼åŒºé–“ vs ä¿¡ç”¨åŒºé–“ï¼‰
# 95%ä¿¡ç”¨åŒºé–“ã¨ã¯ä½•ã‹ï¼Ÿ
# é »åº¦è«–ã¨ã®é•ã„ã¯ï¼Ÿ
# Q6ï¼ˆäº‹å‰åˆ†å¸ƒè¨­è¨ˆï¼‰
# æ¬¡ã®å ´åˆã€ã©ã‚“ãª prior ãŒè‡ªç„¶ï¼Ÿ
# æ–°æ©Ÿèƒ½ï¼ˆéå»ãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰
# æ—¢å­˜UIå¾®ä¿®æ­£ï¼ˆéå»ã‚ã‚Šï¼‰
# Q7ï¼ˆé€æ¬¡æ„æ€æ±ºå®šï¼‰
# ãƒ™ã‚¤ã‚¸ã‚¢ãƒ³ãŒ é€”ä¸­åœæ­¢ ã«å¼·ã„ç†ç”±ã€‚
# Q8ï¼ˆå°æ¨™æœ¬ï¼‰
# ã‚µãƒ³ãƒ—ãƒ«ãŒå°‘ãªã„ã¨ãã€ãƒ™ã‚¤ã‚ºãŒæœ‰åˆ©ãªç†ç”±ã€‚
# Q9ï¼ˆãƒ“ã‚¸ãƒã‚¹ï¼‰
# ã€ŒBãŒè‰¯ã„ç¢ºç‡80%ã€æœŸå¾…æ”¹å–„ç‡+1%ã€
# ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹?
# ä½•ã‚’è€ƒæ…®ã™ã‚‹?
# Q10ï¼ˆè½ã¨ã—ç©´ï¼‰
# ãƒ™ã‚¤ã‚ºã§ã‚‚ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨ã‚’3ã¤ã€‚
# Q1 ã†ã¾ãæ›´æ–°ã•ã‚Œãªã„ï¼Ÿ
# Q2 äº‹å¾Œåˆ†å¸ƒã¯0.7?

alpha_A, beta_A = 1, 1  # äº‹å‰åˆ†å¸ƒ
alpha_B, beta_B = 1, 1

success_A = 500  # äº‹å¾Œåˆ†å¸ƒ
fail_A = 1000 - success_A
success_B = 550
fail_B = 1000 - success_B

alpha_A += success_A  # æ›´æ–°
beta_A += fail_A
alpha_B += success_B
beta_B += fail_B

posterior_A = s_s_beta(
    alpha_A, beta_A
)  # äº‹å¾Œåˆ†å¸ƒã‹ã‚‰ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã§åˆ†å¸ƒã‚’ä½œã‚‹ã€€beta(æˆåŠŸç¢ºç‡ã€å¤±æ•—ç¢ºç‡)ã€€1,1ã ã‘ã¯ç‰¹åˆ¥ã«ä¸€æ§˜åˆ†å¸ƒ
posterior_B = s_s_beta(alpha_B, beta_B)

samples_A = posterior_A.rvs(100000)  # ä½œã£ãŸåˆ†å¸ƒã‹ã‚‰ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
samples_B = posterior_B.rvs(100000)

prob_B_better = np.mean(samples_B > samples_A)
diff = samples_B - samples_A
mean_diff = np.mean(diff)
lower_ci, upper_ci = np.percentile(diff, [2.5, 97.5])
print(f"BãŒAã‚ˆã‚Šå„ªã‚Œã¦ã„ã‚‹ç¢ºç‡: {prob_B_better:.4f}")
print(f"åŠ¹æœé‡ã®å·®ã®å¹³å‡: {mean_diff:.4f}")
print(f"95%ä¿¡é ¼åŒºé–“: ({lower_ci:.4f}, {upper_ci:.4f})")
# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 6))
plt.hist(samples_A, bins=50, alpha=0.5, label="Aç¾¤", color="blue", density=True)
plt.hist(samples_B, bins=50, alpha=0.5, label="Bç¾¤", color="red", density=True)
plt.legend()
plt.title("Aç¾¤ã¨Bç¾¤ã®äº‹å¾Œåˆ†å¸ƒ")
plt.xlabel("CVR")
plt.ylabel("ç¢ºç‡å¯†åº¦")
plt.savefig("baysian.png")
